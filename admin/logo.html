<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<title>Logo - Admin</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-storage.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-firestore.js"></script>
<script src="../assets/js/firebase.js"></script>
</head>
<body>
<div class="container py-4">
  <h3>Trocar Logotipo</h3>
  <input type="file" id="fileLogo" class="form-control mb-2">
  <button id="btnUploadLogo" class="btn btn-primary">Enviar</button>
  <div id="preview" class="mt-3"></div>
</div>

<script>
$("#btnUploadLogo").click(function(){
  const f = $("#fileLogo")[0].files[0];
  if(!f) return alert("Escolha um arquivo");
  const storageRef = firebase.storage().ref();
  const up = storageRef.child('logo/'+Date.now()+'_'+f.name).put(f);
  up.on('state_changed', null, err=>alert(err.message), () => {
    up.snapshot.ref.getDownloadURL().then(url=>{
      firebase.firestore().collection('config').doc('logo').set({url: url});
      $("#preview").html('<img src="'+url+'" height="80">');
      alert("Logotipo atualizado");
    });
  });
});
</script>
</body>
</html>
